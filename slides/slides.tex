\documentclass[aspectratio=169]{beamer}
\usetheme{Singapore}
\addtobeamertemplate{navigation symbols}{}{%
    \usebeamerfont{footline}%
    \usebeamercolor[fg]{footline}%
    \hspace{1em}%
    \raisebox{1.4pt}[0pt][0pt]{\insertframenumber/\inserttotalframenumber}
}
\setbeamercolor{footline}{fg=blue!50}
\setbeamerfont{footline}{series=\bfseries}

\usefonttheme[onlymath]{serif}

\usepackage{cmap}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[kerning=true]{microtype}
\usepackage{lmodern}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}

\usepackage{mathtools}
\usepackage{wrapfig}
\usepackage{enumitem}
\usepackage{tikz}

\usepackage[
    backend=biber,
    style=numeric,
]{biblatex}
\usepackage{graphicx}

\graphicspath{{./images/}}

\addbibresource{../report/report.bib}
\renewcommand*{\bibfont}{\footnotesize}

\AtBeginSection[]
{
  \begin{frame}
    \frametitle{Plan}
    \tableofcontents[currentsection]
  \end{frame}
}


\theoremstyle{definition}
\newtheorem*{exemple}{Example}



\title{\textbf{Extending Layerwise Relevance Propagation using Semiring Annotations}}

\author{%
  \texorpdfstring{%
    \begin{columns}
      \column{.5\linewidth}
      \centering
      \textbf{Antoine Groudiev} \\ L3, ENS Ulm
      \column{.5\linewidth}
      \centering
      \textbf{Silviu Maniu} -- Supervisor \\ SLIDE Team, LIG
    \end{columns}
 }
 {Antoine Groudiev, Silviu Maniu}
}

\date{Tuesday, July 9th}

\begin{document}
\frame{\titlepage}

%\begin{frame}{Plan}
%    \tableofcontents
%\end{frame}

\section{Introduction}
\subsection{Problem statement}
\begin{frame}{Problem statement}

\end{frame}

\subsection{Layerwise Relevance Propagation}
\begin{frame}{Layerwise Relevance Propagation}
    \begin{figure}[H]
        \includegraphics[width=\textwidth]{LRP.png}
    \end{figure}
\end{frame}

\begin{frame}{Layerwise Relevance Propagation}{Propagation rules}
    Initialization:
    \begin{equation}
        R^{(L)}_i = \begin{cases*}
            a^{(L)}_i & if $i = y$\\
            0 & otherwise
        \end{cases*}
    \end{equation}

    LRP-0 rule:
    \begin{equation}
        R^{(l)}_j = \sum_{k}\frac{a^{(l)}_jw_{j, k}}{\sum_{j'}a^{(l)}_{j'}w_{j', k}} R^{(l+1)}_k
    \end{equation}
\end{frame}

\begin{frame}{Layerwise Relevance Propagation}{Results visualization}
    \begin{tabular}[pos]{cc}
        \includegraphics[width=.4\textwidth]{mnist-lrp.png}
        &
        \includegraphics[width=.4\textwidth]{castle-lrp.png}
    \end{tabular}
\end{frame}

\begin{frame}{Pertinence of LRP results}
    \begin{figure}[H]
        \includegraphics[width=.5\textwidth]{dmnist-lrp.png}
    \end{figure}
\end{frame}

\subsection{Semiring-based provenance annotations}
\begin{frame}{Semiring-based provenance annotations}
    \begin{definition}[Semiring]
        A semiring $(\mathbb{K}, \oplus, \otimes, \mathbf{0}, \mathbf{1})$ is composed of a set $\mathbb{K}$, binary operators $\oplus$ and $\otimes$ such that $\otimes$ distributes over $\oplus$, verifying the following properties:
        \begin{itemize}[label=--, noitemsep]
            \item $(\mathbb{K}, \oplus, \mathbf{0})$ is a commutative monoid
            \item $(\mathbb{K}, \otimes, \mathbf{1})$ is a monoid such that $\mathbf{0}$ is absorbing
        \end{itemize}
    \end{definition}

    \begin{exemple}
        The following structures are semirings:
        \begin{itemize}[label=--, noitemsep]
            \item Real semiring: $(\mathbb{R}, +, \times, 0, 1)$
            \item Boolean semiring: $(\{\bot, \top\}, \lor, \land, \bot, \top)$
            \item Counting semiring: $(\mathbb{N}, +, \times, 0, 1)$
            \item Viterbi semiring: $([0, 1], \max, \times, 0, 1)$
        \end{itemize}
    \end{exemple}
\end{frame}

\section{Extending LRP}
\begin{frame}{Simplifying LRP rule}
    Remove the denominator:
    \begin{equation*}
        R^{(l)}_j = \sum_k\frac{a^{(l)}_jw_{j, k}^{(l)}}{\sum_{j'}a^{(l)}_{j'}w_{j', k}^{(l)}} R^{(l+1)}_k \quad \longrightarrow \quad R^{(l)}_j = \sum_{k} a^{(l)}_jw_{j, k}^{(l)} \cdot R^{(l+1)}_k
    \end{equation*}
\end{frame}

\begin{frame}{Semiring generalization of the LRP rule}
    Conversion functions for activations, weights:
    \begin{equation*}
        \begin{aligned}
            \Theta_a : \mathbb{R}Â &\longrightarrow \mathbb{K}\\
            \Theta_w : \mathbb{R} &\longrightarrow \mathbb{K}
        \end{aligned}
    \end{equation*}
    Initialization:
    \begin{equation}
        R^{(L)}_i = \begin{cases*}
            \Theta_a\left(a^{(L)}_i\right) & if $i = y$\\
            \mathbf{0} & otherwise
        \end{cases*}
    \end{equation}
    Propagation rule:
    \begin{equation}
        R^{(l)}_j = \bigoplus_k \Theta_a\left(a^{(l)}_j\right) \otimes \Theta_w\left(w_{j, k}^{(l)}\right) \otimes R^{(l+1)}_k
    \end{equation}
\end{frame}

\begin{frame}{Boolean Semiring}{\large $(\{\bot, \top\}, \lor, \land, \bot, \top)$}
    \begin{equation*}
        \Theta_a = a \longmapsto \begin{cases*}
            \top & if $a\geq\theta_a$\\
            \bot & otherwise
        \end{cases*}
        \qquad\qquad
        \Theta_w = w \longmapsto \begin{cases*}
            \top & if $w\geq\theta_w$\\
            \bot & otherwise
        \end{cases*}
    \end{equation*}

    \begin{figure}[H]
        \centering
        \includegraphics[width=.5\textwidth]{boolean.png}
    \end{figure}
\end{frame}

\begin{frame}{Influence of the thresholds}
    \begin{figure}
        \centering
        \includegraphics[width=.6\textwidth]{boolean-threshold.png}
    \end{figure}
\end{frame}

\begin{frame}{Counting Semiring}{\large $(\mathbb{N}, +, \times, 0, 1)$}
    \begin{equation*}
        \Theta_a = a \longmapsto \begin{cases*}
            1 & if $a\geq\theta_a$\\
            0 & otherwise
        \end{cases*}
        \qquad\qquad
        \Theta_w = w \longmapsto \begin{cases*}
            1 & if $w\geq\theta_w$\\
            0 & otherwise
        \end{cases*}
    \end{equation*}

    \begin{figure}[H]
        \centering
        \includegraphics[width=.5\textwidth]{counting.png}
    \end{figure}
\end{frame}

% \begin{frame}{Viterbi Semiring}{\large $([0, 1], \max, \times, 0, 1)$}
%     \begin{equation*}
%         \Theta_a = a \longmapsto a
%         \qquad\qquad
%         \Theta_w = w \longmapsto w
%     \end{equation*}

%     \begin{figure}[H]
%         \centering
%         \includegraphics[width=.5\textwidth]{viterbi.png}
%     \end{figure}
% \end{frame}

\section{Applications}
\subsection{Image mask computation}
\begin{frame}{Image mask computation}
    
\end{frame}

\subsection{Network pruning using LRP ranking}
\begin{frame}{Network pruning using LRP ranking}
    
\end{frame}

\subsection{Comparison to image perturbation}
\begin{frame}{Comparison to image perturbation}
    \begin{figure}
        \includegraphics[width=.7\textwidth]{attacks.png}
        \caption{Accuracies per attack zone}
    \end{figure}
\end{frame}

\section{Conclusion}
\begin{frame}
    \nocite{*}
    \printbibliography
\end{frame}

\end{document}